steel.d("logic/header",["kit/dom/parseDOM","common/trans/login","../ui/confirm","common/channel/onBorrow"],function(a,b,c){a("kit/dom/parseDOM"),a("common/trans/login");var d=STK;c.exports=function(b){var c={},e=a("../ui/confirm"),f=a("common/channel/onBorrow"),g={DOM:{},objs:{},DOM_eventFun:{user:function(){g.DOM.logout&&(d.stopEvent(),"none"===d.getStyle(g.DOM.logout,"display")?d.setStyle(g.DOM.logout,"display","block"):d.setStyle(g.DOM.logout,"display","none"))},logout:function(){var a={};a={title:"确认注销？",description:"",button1:"取消",button2:"确认"},g.objs.confirmObj=e(a),d.custEvent.add(g.objs.confirmObj,"button2Click",g.bindCustEvtFuns.loginout)},back:function(){window.history.back()},hide:function(){g.DOM.logout&&"block"===d.getStyle(g.DOM.logout,"display")&&d.setStyle(g.DOM.logout,"display","none")},myBookClick:function(){d.setStyle(g.DOM.circlePoint,"display","none")}},bindCustEvtFuns:{loginout:function(){window.location="http://catfood.wap.grid.sina.com.cn/catfood/logout"}},bindListenerFuns:{circlePoint:function(){d.setStyle(g.DOM.circlePoint,"display","inline-block")}}},h=function(){if(null==b||null!=b&&!d.isNode(b))throw"[]:argsCheck()-The param node is not a DOM node."},i=function(){g.DOM=d.kit.dom.parseDOM(d.builder(b).list)},j=function(){},k=function(){d.addEvent(g.DOM.user,"click",g.DOM_eventFun.user),d.addEvent(g.DOM.logout,"click",g.DOM_eventFun.logout),d.addEvent(g.DOM.back,"click",g.DOM_eventFun.back),d.addEvent(document,"click",g.DOM_eventFun.hide),d.addEvent(g.DOM.mybook,"click",g.DOM_eventFun.myBookClick)},l=function(){},m=function(){f.register("borrow",g.bindListenerFuns.circlePoint)},n=function(){var a=window.location.pathname.split("/"),b=a[a.length-1];"login"===b?(d.setStyle(g.DOM.user,"display","none"),d.setStyle(g.DOM.mybook,"display","none")):"mybooklist"===b&&(d.setStyle(g.DOM.mybook,"display","none"),d.setStyle(g.DOM.back,"display","block"))},o=function(){g&&(d.removeEvent(g.DOM.user,"click",g.DOM_eventFun.user),d.removeEvent(g.DOM.logout,"click",g.DOM_eventFun.logout),d.removeEvent(g.DOM.back,"click",g.DOM_eventFun.back),d.removeEvent(document,"click",g.DOM_eventFun.hide),d.removeEvent(g.DOM.mybook,"click",g.DOM_eventFun.myBookClick),d.foreach(g.objs,function(a){a&&a.destroy&&a.destroy()}),g=null)},p=function(){h(),i(),n(),j(),k(),l(),m()};return p(),c.destroy=o,c}}),steel.d("kit/dom/parseDOM",[],function(a,b,c){STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&1==a[b].length&&(a[b]=a[b][0]);return a}})}),steel.d("common/trans/login",["kit/io/inter"],function(a,b,c){a("kit/io/inter"),STK.register("common.trans.login",function(a){var b=a.kit.io.inter(),c=b.register;return c("login",{url:"/aj/login/login",method:"get"}),c("loginout",{url:"/aj/login/loginout",method:"get"}),b})}),steel.d("kit/io/inter",["kit/io/ajax","kit/io/jsonp","kit/extra/merge"],function(a,b,c){a("kit/io/ajax"),a("kit/io/jsonp"),a("kit/extra/merge"),STK.register("kit.io.inter",function(a){return function(){var b,c,d;return b={},c={},d={},b.register=function(a,b){if(void 0!==c[a])throw a+" interface has been registered";c[a]=b,d[a]={}},b.hookComplete=function(b,c){var e=a.core.util.getUniqueKey();return d[b][e]=c,e},b.removeHook=function(a,b){d[a]&&d[a][b]&&delete d[a][b]},b.getTrans=function(b,e){var f=a.kit.extra.merge(c[b],e);return f.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if("100000"===a.code||"A00006"===a.code)try{e.onSuccess(a,c)}catch(f){}else try{if("100002"===a.code)return void(location.href="/catfood/login");if("100107"===a.code)return;e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}},"jsonp"===c[b].requestMode?a.kit.io.jsonp(f):"ijax"===c[b].requestMode?a.kit.io.ijax(f):a.kit.io.ajax(f)},b.request=function(b,e,f){var g=a.core.json.merge(c[b],e);return g.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if("100000"===a.code||"A00006"===a.code)try{e.onSuccess(a,c)}catch(f){}else try{if("100002"===a.code)return void(window.location.href=a.data);e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}},g=a.core.obj.cut(g,["noqueue"]),g.args=f,"jsonp"===c[b].requestMode?a.jsonp(g):"ijax"===c[b].requestMode?a.ijax(g):a.ajax(g)},b}})}),steel.d("kit/io/ajax",["kit/extra/merge","kit/io/orignAjax"],function(a,b,c){a("kit/extra/merge"),a("kit/io/orignAjax"),STK.register("kit.io.ajax",function(a){return function(b){var c,d,e,f,g,h,i;h=function(a){g=!1,b.onComplete(a,c.args),setTimeout(j,0)},i=function(a){g=!1,b.onFail(a,c.args),setTimeout(j,0)},e=[],f=null,g=!1,c=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},b),c.onComplete=h,c.onFail=i;var j=function(){e.length&&g!==!0&&(g=!0,c.args=e.shift(),f=a.kit.io.orignAjax(c))},k=function(a){for(;e.length;)e.shift();if(g=!1,f)try{f.abort()}catch(b){}f=null};return d={},d.request=function(c){if(c||(c={}),b.noQueue&&k(),window.$CONFIG&&$CONFIG.pageextra){var d=a.queryToJson($CONFIG.pageextra);if(d)for(var g in d)c[g]=d[g]}b.uniqueRequest&&f||(e.push(c),c._t=0,j())},d.abort=k,d}})}),steel.d("kit/extra/merge",[],function(a,b,c){STK.register("kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}})}),steel.d("kit/io/orignAjax",[],function(require,exports,module){STK.register("kit.io.orignAjax",function($){return function(oOpts){var opts=$.core.obj.parseParam({url:"",charset:"UTF-8",timeout:3e4,args:{},onComplete:null,onTimeout:$.core.func.empty,uniqueID:null,onFail:$.core.func.empty,method:"get",asynchronous:!0,header:{},isEncode:!1,responseType:"json"},oOpts);if(""==opts.url)throw"ajax need url in parameters object";var tm,trans=$.core.io.getXHR(),cback=function(){if(4==trans.readyState){clearTimeout(tm);var data="";if("xml"===opts.responseType)data=trans.responseXML;else if("text"===opts.responseType)data=trans.responseText;else try{data=trans.responseText&&"string"==typeof trans.responseText?eval("("+trans.responseText+")"):{}}catch(exp){data=opts.url+"return error : data error"}200==trans.status?null!=opts.onComplete&&opts.onComplete(data):0==trans.status||null!=opts.onFail&&opts.onFail(data,trans)}else null!=opts.onTraning&&opts.onTraning(trans)};if(trans.onreadystatechange=cback,opts.header["Content-Type"]||(opts.header["Content-Type"]="application/x-www-form-urlencoded"),opts.header["X-Requested-With"]||(opts.header["X-Requested-With"]="XMLHttpRequest"),"get"==opts.method.toLocaleLowerCase()){var url=$.core.util.URL(opts.url,{isEncodeQuery:opts.isEncode});url.setParams(opts.args),url.setParam("__rnd",(new Date).valueOf()),trans.open(opts.method,url,opts.asynchronous);try{for(var k in opts.header)trans.setRequestHeader(k,opts.header[k])}catch(exp){}trans.send("")}else{trans.open(opts.method,opts.url,opts.asynchronous);try{for(var k in opts.header)trans.setRequestHeader(k,opts.header[k])}catch(exp){}trans.send($.core.json.jsonToQuery(opts.args,opts.isEncode))}return opts.timeout&&(tm=setTimeout(function(){try{trans.abort()}catch(a){}opts.onTimeout({},trans),opts.onFail({code:"100001",msg:"Request timeout！"})},opts.timeout)),trans}})}),steel.d("kit/io/jsonp",["kit/extra/merge"],function(a,b,c){a("kit/extra/merge"),STK.register("kit.io.jsonp",function(a){return function(b){var c,d,e,f,g;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),e=[],f={},g=!1;var h=function(){e.length&&g!==!0&&(g=!0,f.args=e.shift(),f.onComplete=function(a){g=!1,c.onComplete(a,f.args),setTimeout(h,0)},f.onFail=function(a){g=!1,c.onFail(a),setTimeout(h,0)},a.jsonp(a.kit.extra.merge(c,{args:f.args,onComplete:function(a){f.onComplete(a)},onFail:function(a){try{f.onFail(a)}catch(b){}}})))};return d={},d.request=function(a){a=a||{},a.superuid||!!$CONFIG.superuid&&(a.superuid=$CONFIG.superuid),a||(a={}),e.push(a),a._t=1,h()},d.abort=function(a){for(;e.length;)e.shift();g=!1,f=null},d}})}),steel.d("ui/confirm",["kit/dom/parseDOM","ui/comfirmHTML"],function(a,b,c){var d=STK;a("kit/dom/parseDOM"),c.exports=function(b){var c={},e={objs:{},DOM:{},DOM_eventFun:{button1Fun:function(){document.body.removeChild(e.DOM.confirm),document.body.removeChild(e.DOM.blockDiv),d.custEvent.fire(c,"button1Click")},button2Fun:function(){document.body.removeChild(e.DOM.confirm),document.body.removeChild(e.DOM.blockDiv),d.custEvent.fire(c,"button2Click")}}},f=function(){var c=a("ui/comfirmHTML");html=c({arg:b});var f=d.core.dom.builder(html);document.body.appendChild(f.box),e.DOM=d.kit.dom.parseDOM(f.list),b.description&&(e.DOM.description.innerHTML=b.description)},g=function(){},h=function(){if(!b.title||!b.button1||!b.button2)throw new Error("参数错误！")},i=function(){d.core.evt.addEvent(e.DOM.button1,"click",e.DOM_eventFun.button1Fun),d.core.evt.addEvent(e.DOM.button2,"click",e.DOM_eventFun.button2Fun)},j=function(){d.custEvent.define(c,["button1Click","button2Click"])},k=function(){},l=function(){e&&(d.foreach(e.objs,function(a){a.destroy&&a.destroy()}),d.removeEvent(e.DOM.button1,"click",e.DOM_eventFun.button1Fun),d.removeEvent(e.DOM.button2,"click",e.DOM_eventFun.button2Fun),e=null)},m=function(){h(),f(),g(),i(),j(),k()};return m(),c.destroy=l,c}}),steel.d("ui/comfirmHTML",["tpl/runtime"],function(a,b,c){var d=a("tpl/runtime"),e=void 0;c.exports=function(a){var b,c=[],f=a||{};return function(a){c.push('<div node-type="blockDiv" class="blockDiv"></div><div node-type="confirm" class="confirm"><table cellspacing="1"><tr class="confirmMsg"><td rowspan="2" colspan="2"><p class="title">'+d.escape(null==(b=a.title)?"":b)+"</p>"),a.description&&c.push('<p node-type="description" class="description"></p>'),c.push('</td></tr><tr></tr><tr class="operator"><td node-type="button1">'+d.escape(null==(b=a.button1)?"":b)+'</td><td node-type="button2">'+d.escape(null==(b=a.button2)?"":b)+"</td></tr></table></div>")}.call(this,"arg"in f?f.arg:"undefined"!=typeof arg?arg:e),c.join("")}}),steel.d("tpl/runtime",[],function(a,b,c){!function(a){function b(a){return null!=a&&""!==a}function c(a){window.steel&&!steel.isDebug&&steel.logBee&&steel.logBee("9001","Seteel框架的模板错误："+a)}function d(a){return q(a)?a.map(d).filter(b).join(" "):a}var e=Object.prototype,f=(String.prototype,Function.prototype),g=Array.prototype,h=e.hasOwnProperty,i=(g.slice,e.toString),j=(f.call,!{toString:null}.propertyIsEnumerable("toString")),k=(function(){}.propertyIsEnumerable("prototype"),["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]),l=k.length,m={ToObject:function(a){if(null==a)throw c(a),new TypeError("can't convert "+a+" to object");return Object(a)}},n=Object("a"),o="a"!==n[0]||!(0 in n),p=(k.length,function(a){return"[object Function]"===i.call(a)}),q=g.isArray?function(a){return g.isArray(a)}:function(a){return"[object Array]"===i.call(a)},r=function(a){return"[object String]"===i.call(a)};g.map=g.map||function(a){var b=m.ToObject(this),d=o&&r(this)?this.split(""):b,e=d.length>>>0,f=Array(e),g=arguments[1];if(!p(a))throw c(a),new TypeError(a+" is not a function");for(var h=0;e>h;h++)h in d&&(f[h]=a.call(g,d[h],h,b));return f},g.filter=g.filter||function(a){for(var b,c=m.ToObject(this),d=o&&r(this)?this.split(""):c,e=d.length>>>0,f=[],g=arguments[1],h=0;e>h;h++)h in d&&(b=d[h],a.call(g,b,h,c)&&f.push(b));return f},Object.keys=Object.keys||function(a){if("object"!=typeof a&&"function"!=typeof a||null===a){var b="Object keys method called on non-object";throw c(b),new TypeError(b)}var d=[];for(var e in a)h.call(a,e)&&d.push(e);if(j)for(var f=0;l>f;){var g=k[f];h.call(a,g)&&d.push(g),f++}return d},a.merge=function s(a,c){if(1===arguments.length){for(var d=a[0],e=1;e<a.length;e++)d=s(d,a[e]);return d}var f=a["class"],g=c["class"];(f||g)&&(f=f||[],g=g||[],q(f)||(f=[f]),q(g)||(g=[g]),a["class"]=f.concat(g).filter(b));for(var h in c)"class"!=h&&(a[h]=c[h]);return a},a.joinClasses=d,a.cls=function(b,c){for(var e=[],f=0;f<b.length;f++)c&&c[f]?e.push(a.escape(d([b[f]]))):e.push(d(b[f]));var g=d(e);return g.length?' class="'+g+'"':""},a.attr=function(b,c,d,e){return"boolean"==typeof c||null==c?c?" "+(e?b:b+'="'+b+'"'):"":0==b.indexOf("data")&&"string"!=typeof c?" "+b+"='"+jSON.stringify(c).replace(/'/g,"&apos;")+"'":d?" "+b+'="'+a.escape(c)+'"':" "+b+'="'+c+'"'},a.attrs=function(b,c){var e=[],f=Object.keys(b);if(f.length)for(var g=0;g<f.length;++g){var h=f[g],i=b[h];"class"==h?(i=d(i))&&e.push(" "+h+'="'+i+'"'):e.push(a.attr(h,i,!1,c))}return e.join("")},a.escape=function(a){var b=String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return b===""+a?a:b},a.rethrow=function t(a,b,d,e){if(!(a instanceof Error))throw a;if(!("undefined"==typeof window&&b||e))throw a.message+=" on line "+d,c(a),a;try{e=e||_dereq_("fs").readFileSync(b,"utf8")}catch(f){t(a,null,d)}var g=3,h=e.split("\n"),i=Math.max(d-g,0),j=Math.min(h.length,d+g),g=h.slice(i,j).map(function(a,b){var c=b+i+1;return(c==d?"  > ":"    ")+c+"| "+a}).join("\n");throw a.path=b,a.message=(b||"Jade")+":"+d+"\n"+g+"\n\n"+a.message,c(a),a}}(c.exports)}),steel.d("common/channel/onBorrow",["common/listener"],function(a,b,c){a("common/listener"),c.exports=STK.common.listener.define("common.channel.onBorrow","borrow")}),steel.d("common/listener",[],function(a,b,c){STK.register("common.listener",function(a){var b={},c={};return c.define=function(c,d){if(null!=b[c])throw"common.listener.define: 频道已被占用";b[c]=d;var e={};return e.register=function(d,e){if(null==b[c])throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)},e.fire=function(d,e){if(null==b[c])throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)},e.remove=function(b,d){a.listener.remove(c,b,d)},e.cache=function(b){return a.listener.cache(c,b)},e},c})});